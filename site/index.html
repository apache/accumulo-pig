---
layout: default
title: Accumulo Pig
---
<div id="header">
<span class="h1">Omg accumuload and pigs?!?</span>
<span style="float:right;"><img src="images/pig.gif" height="70px" alt="pig" /><img src="images/accumulo.png" height="70px" alt="accumulo" style="padding-left:15px"/></span>
</div>

<div id="introduction">
    <p> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce ut
    neque quis magna volutpat mollis ac nec orci. In ut felis quam. Nunc
    fermentum neque dui, ac consequat risus sodales eget. Morbi consectetur
    vel ligula nec volutpat. Curabitur tincidunt est sed dapibus euismod.
    Integer ut urna tempus, pulvinar ante ac, porttitor nisi. Sed
    ullamcorper sodales est aliquam facilisis. Ut ut sem convallis, sodales
    massa eget, adipiscing nisl. Integer eget commodo tellus. In convallis
    leo dui, at sagittis est sagittis a. Vestibulum id neque molestie,
    ultricies velit in, feugiat diam. Praesent vitae lorem sed elit
    consectetur lobortis eget eu dui. Suspendisse quis commodo sapien.
    Nullam semper quis urna ac interdum. Duis a velit sem. 
    </p>

    <pre class="codepre">
<span class="comment">-- Read a reduced set of our flight data</span>
<span class="variable">flight_data</span> = <span class="keyword">LOAD</span> <span class="constants">'accumulo://flights?instance=accumulo&user=pig&password=password&zookeepers=localhost&fetch_columns=destination,departure_time,scheduled_departure_time,flight_number,taxi_in,taxi_out,origin'</span>
    <span class="keyword">USING</span> org.apache.accumulo.pig.AccumuloStorage() <span class="keyword">AS</span> (rowkey:<span class="type">chararray</span>, data:<span class="type">map[]</span>);

<span class="comment">-- Also read airport information</span>
<span class="variable">airports</span> = <span class="keyword">LOAD</span> <span class="constants">'accumulo://airports?instance=accumulo&user=pig&password=password&zookeepers=localhost'</span> <span class="keyword">USING</span>
    org.apache.accumulo.pig.AccumuloStorage() <span class="keyword">AS</span> (rowkey:<span class="type">chararray</span>, data:<span class="type">map[]</span>);

<span class="comment">-- Permute the map</span>
<span class="variable">flight_data</span> = <span class="keyword">FOREACH</span> <span class="variable">flight_data</span> <span class="keyword">GENERATE</span> rowkey, data#<span class="constants">'origin'</span> <span class="keyword">AS</span> origin, data#<span class="constants">'destination'</span> <span class="keyword">AS</span> destination, data#<span class="constants">'departure_time'</span> <span class="keyword">AS</span> departure_time,
    data#<span class="constants">'scheduled_departure_time'</span> <span class="keyword">AS</span> scheduled_departure_time, data#<span class="constants">'flight_number'</span> <span class="keyword">AS</span> flight_number, data#<span class="constants">'taxi_in'</span> <span class="keyword">AS</span> taxi_in, data#<span class="constants">'taxi_out'</span> <span class="keyword">AS</span> taxi_out;

<span class="comment">-- Permute the map</span>
<span class="variable">airports</span> = <span class="keyword">FOREACH</span> <span class="variable">airports</span> <span class="keyword">GENERATE</span> data#<span class="constants">'name'</span> <span class="keyword">AS</span> name, data#<span class="constants">'state'</span> <span class="keyword">AS</span> state, data#<span class="constants">'code'</span> <span class="keyword">AS</span> code, data#<span class="constants">'country'</span> <span class="keyword">AS</span> country, data#<span class="constants">'city'</span. <span class="keyword">AS</span> city;

<span class="comment">-- Add airport information about the origin of the flight</span>
<span class="variable">flights_with_origin</span> = <span class="keyword">JOIN</span> <span class="variable">flight_data</span> <span class="keyword">BY</span> origin, <span class="variable">airports</span> <span class="keyword">BY</span> code;

<span class="comment">-- Store this information back into Accumulo in a new table</span>
<span class="keyword">STORE</span> <span class="variable">flights_with_origin</span> <span class="keyword">INTO</span> <span class="constants">'accumulo://flights_with_airports?instance=accumulo1.4&user=root&password=secret&zookeepers=localhost'</span> \
    <span class="keyword">USING</span> org.apache.accumulo.pig.AccumuloStorage(<span class="constants">'origin,destination,departure_time,scheduled_departure_time,flight_number,taxi_in,taxi_out,name,state,code,country,city'</span>);
    </pre>

    <p> Vestibulum vulputate nisi non imperdiet elementum. Pellentesque at
    consequat nisi. Fusce ut luctus justo. Aenean tincidunt ut risus
    condimentum convallis. Praesent eget tristique risus. Cras pellentesque sed
    libero ac elementum. Quisque tempus commodo neque, laoreet accumsan lectus
    sollicitudin eget. In convallis neque nisi, a iaculis neque interdum ac.
    Suspendisse in ante lacinia dolor faucibus auctor.
    </p>

    <p>Nulla fringilla quis turpis a gravida. Quisque tellus arcu, sagittis et sapien
    ut, imperdiet scelerisque est. Duis sapien mi, elementum vitae sem quis, varius
    tincidunt tortor. In commodo semper magna. Donec ultrices nunc est, nec
    volutpat leo porta scelerisque. Praesent tellus leo, scelerisque eget tortor
    eget, posuere sodales nulla. Mauris imperdiet magna eget tristique consequat.
    Nullam adipiscing at arcu in vestibulum. Donec consectetur justo sed odio
    vehicula, vel lobortis libero vehicula. Fusce rutrum justo lorem, sed bibendum
    ipsum ultrices eget. Praesent lobortis justo quis sem adipiscing rutrum ac eget
    nisi. Pellentesque et justo in leo rutrum rhoncus a ut neque. Fusce faucibus,
    orci nec venenatis dapibus, est leo ornare eros, ac adipiscing erat felis sit
    amet tellus. Nulla vehicula ipsum sit amet accumsan tempor.
    </p>

    <p>Nulla ac est tincidunt, lacinia quam nec, mollis ante. Nulla ut tincidunt
    massa, vel laoreet elit. Aliquam erat volutpat. Mauris varius dolor in eros
    blandit adipiscing. Nam ultrices tellus quam, eu porta quam varius ac.
    Phasellus in massa fringilla, mattis nisi vel, condimentum diam. Cras porttitor
    eget arcu vel tempor.
    </p>

    <p>Ut id vestibulum lorem. Fusce vitae metus sed magna tincidunt vestibulum. Fusce
    in eros ac nulla vestibulum venenatis vitae vitae nisi. Donec elementum neque
    ac viverra cursus. Morbi tincidunt venenatis tellus, id facilisis nibh viverra
    eget. Aenean pellentesque gravida orci, sed elementum nisl vulputate at.
    Suspendisse ut orci vitae tortor viverra egestas id scelerisque ante. Praesent
    vel tempor justo, id tempor lacus. Proin convallis vehicula mauris. Suspendisse
    tincidunt et libero vitae condimentum. Nam arcu urna, sollicitudin nec diam
    congue, ultricies hendrerit mi. Vivamus viverra elit in libero rutrum commodo.
    Ut eget varius arcu, ac venenatis tellus. Quisque rutrum blandit velit in
    sollicitudin. Maecenas nibh purus, consectetur at elementum at, dictum et
    dolor. 
    </p>
</div>
<p/>
    <!--
    <div id="posts">
    {% for post in paginator.posts %}
        <div class="post">
            <div class="title">
                <h3 class="title"><a href="{{ post.url }}">{{ post.title }}</a></h3>
            </div>

            <div class="content">
                {{ post.content }}
            </div>

            <div class="pre_footer"></div>

            <div class="post_footer">
                <p>Posted: {{ post.date | date_to_string }}</p>
            </div>
        </div>
    {% endfor %}
    </div>
    -->

    <!--
    {% if paginator.total_pages > 1 %}
        <!-- Pagination links -->
        <div class="pagination">
        {% if paginator.previous_page %}
            {% if paginator.previous_page == 1 %}
            <a href="/" class="previous">Previous</a>
            {% else %}
            <a href="/page{{paginator.previous_page}}" class="previous">Previous</a>
            {% endif %}
        {% endif %}
        <span class="page_number ">{{paginator.page}} of {{paginator.total_pages}}</span>
        {% if paginator.next_page %}
            <a href="/page{{paginator.next_page}}" class="next ">Next</a>
        {% endif %}
        </div>
    {% endif %}
    -->

